<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Co dzisiaj robimy</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <h1>Co dzisiaj robimy?</h1>
    <div id="buttons-init">
        <button onmousedown="good_choice_message()" id="btn1" onmouseover="btn1_mouse_status(true)" onmouseout="btn1_mouse_status(false)">Oglądamy samochody</button>
        <button id="btn2">Oglądamy Marvel</button>
    </div>

    <div id="good_choice_div" style="display: none;">
        <h2>Świetny wybór!</h2>
        <p>Skontaktuj sie ze swoim chlopakiem i jak najszybciej powiadom go o tej niesamoiwtej decyzji!</p>
        <p id="good_choice_close" onmousedown="close_good_choice()">X</p>
    </div>



    <script>
        good_choice_div = document.getElementById("good_choice_div");
        mouse_over_btn1 = false;

        function close_good_choice(){
            good_choice_div.setAttribute('style', 'display: none;')
        }





        

        function btn1_mouse_status(n){
            mouse_over_btn1  =n;
        }

        btn2 = document.getElementById('btn2');

        function getNumericStyleProperty(style, prop){
            return parseInt(style.getPropertyValue(prop),10) ;
        }

        function element_position(e) {
            var x = 0, y = 0;
            var inner = true ;
            do {
                x += e.offsetLeft;
                y += e.offsetTop;
                var style = getComputedStyle(e,null) ;
                var borderTop = getNumericStyleProperty(style,"border-top-width") ;
                var borderLeft = getNumericStyleProperty(style,"border-left-width") ;
                y += borderTop ;
                x += borderLeft ;
                if (inner){
                var paddingTop = getNumericStyleProperty(style,"padding-top") ;
                var paddingLeft = getNumericStyleProperty(style,"padding-left") ;
                y += paddingTop ;
                x += paddingLeft ;
                }
                inner = false ;
            } while (e = e.offsetParent);
            return { x: x, y: y };
        }

        function tp_btn2_to_random(){
            // console.log("teleported!")

            var body = document.body,
            html = document.documentElement;

            var height = Math.max( body.scrollHeight, body.offsetHeight, 
                            html.clientHeight, html.scrollHeight, html.offsetHeight );
            var width = Math.max( body.scrollWidth, body.offsetWidth,
                            html.clientWidth, html.scrollWidth, html.offsetWidth);

            //todo: write sth to repeatadly randomize until conditions are met:
            //1. mouse not too close
            //2. no overlapping
            //morever: subtract sth
            top_size = Math.random() * height-20-50;
            left_size = Math.random() * width-10-125;
            
            console.log(top_size);
            console.log(left_size);
            btn2.setAttribute('style', ("top:"+top_size+"px; left:"+left_size+"px;"));
        }

        addEventListener('mousemove', (e)=>{
            pos =element_position(btn2);
            pos_difference = {x: e.pageX- pos.x - btn2.offsetWidth/2, y: e.pageY- pos.y-btn2.offsetHeight/2};
            // console.log(pos_difference);
            
            distance = Math.sqrt( Math.pow(pos_difference.x, 2) + Math.pow(pos_difference.y, 2));


            max_size_btn2 = btn2.offsetWidth < btn2.offsetHeight ? btn2.offsetWidth : btn2.offsetHeight;
            // console.log(mouse_over_btn1);
            if((distance < 1.4*max_size_btn2)&&!mouse_over_btn1){
                // console.log("now!");
                tp_btn2_to_random();
            }
        });

        function good_choice_message(){

            good_choice_div.setAttribute('style', 'display: block;')
        }

    </script>
</body>

</html>